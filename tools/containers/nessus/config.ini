# Nessus Configuration File
# Pentest-USB Toolkit - Nessus Container Configuration
# Version: 1.0.0

[server]
# Server binding configuration
host = 0.0.0.0
port = 8834
ssl_port = 8834

# SSL/TLS Configuration
ssl_enabled = true
ssl_version = TLSv1.2
ssl_cipher_list = HIGH:!aNULL:!MD5:!RC4:!DH:!DHE

# Certificate settings (auto-generated on first run)
cert_file = /opt/nessus/var/nessus/CA/servercert.pem
key_file = /opt/nessus/var/nessus/CA/serverkey.pem
ca_file = /opt/nessus/var/nessus/CA/cacert.pem

[authentication]
# Authentication settings
session_timeout = 28800
max_sessions = 50
force_pubkey_auth = false
admin_user = admin
admin_password = changeme

# Password policy
min_password_length = 8
password_complexity = true

[scanning]
# Scan performance settings
max_scans = 5
max_hosts = 30
max_checks = 5
max_simult_tcp_sessions = 15
max_simult_hosts = 30

# Network timeouts
network_receive_timeout = 5
network_send_timeout = 60
checks_read_timeout = 5
timeout_checks = 0

# Scan optimization
auto_enable_dependencies = yes
optimize_test = yes
safe_checks = yes
stop_scan_on_disconnect = no

[plugins]
# Plugin configuration
plugin_path = /opt/nessus/lib/nessus/plugins
auto_update_plugins = yes
plugin_update_frequency = daily

# Plugin categories to load
enable_plugin_debugging = no
plugin_upload = no

# Knowledge base settings
include_kb = yes
kb_max_age = 864000
save_knowledge_base = yes

[logging]
# Logging configuration
log_level = normal
log_file = /opt/nessus/var/nessus/logs/nessusd.log
log_whole_attack = yes
log_live_attackers = no

# Log rotation
max_log_size = 100MB
max_log_files = 10

[performance]
# Performance tuning
use_kernel_congestion_detection = yes
reduce_connections_on_congestion = yes
unscanned_closed = yes
silent_dependencies = yes

# Memory management
reduce_mem_usage = no
optimize_test = yes

# CGI paths for web application testing
cgi_path = /cgi-bin:/scripts:/cgi-local:/htbin:/cgibin:/cgis:/cgi-win:/bin

[database]
# Database configuration for scan results
db_type = sqlite
db_path = /opt/nessus/var/nessus/db/nessus.db

# Backup settings
auto_backup = yes
backup_frequency = weekly
backup_retention = 30

[updates]
# Update configuration
auto_update = yes
update_frequency = daily
update_server = updates.nessus.org

# Proxy settings (if needed)
use_proxy = no
proxy_host = 
proxy_port = 
proxy_user = 
proxy_password = 

[api]
# API configuration
api_enabled = yes
api_token_expiry = 86400
max_api_requests = 1000

[reporting]
# Report generation settings
max_report_size = 500MB
report_formats = nessus,html,pdf,csv
default_report_format = html

# Custom report templates
custom_templates_path = /opt/nessus/var/nessus/templates

[security]
# Security settings
encrypt_kb = yes
auto_logout = 1800
force_ssl = yes
disable_xmlrpc = no

# IP restrictions (comma-separated)
allowed_ips = 
denied_ips = 

# User account lockout
max_login_attempts = 5
lockout_duration = 300

[pentest_usb]
# Pentest-USB Toolkit specific settings
integration_mode = enabled
auto_import_targets = yes
export_format = json
api_integration = enabled

# Custom scan templates
default_scan_template = pentest_comprehensive
custom_templates_enabled = yes

# Automation settings
auto_schedule_scans = no
notification_enabled = yes
webhook_url = 

# Integration with other tools
nmap_integration = yes
metasploit_integration = yes
burp_integration = yes